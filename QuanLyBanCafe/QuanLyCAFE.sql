CREATE DATABASE QUANLYCAFE
GO
USE QUANLYCAFE 
GO

IF OBJECT_ID('NHANVIEN') IS  NOT NULL
	DROP TABLE NHANVIEN
GO

CREATE TABLE NHANVIEN (
	ID_NHANVIEN VARCHAR(10) PRIMARY KEY NOT NULL,
	TENNV NVARCHAR(100) NOT NULL,
	GIOITINH BIT NOT NULL,
	NGAYSINH DATE NOT NULL,
	DIACHI NVARCHAR(100),
	EMAIL NVARCHAR(100),
	SDT NVARCHAR(11),
	USERNAME VARCHAR(20) not NULL,
	PASS VARCHAR(20) NOT NULL,
	VAITRO BIT DEFAULT 0,
	TRANGTHAI BIT DEFAULT 1,
	HINH NVARCHAR(100)
)
GO

IF OBJECT_ID('HOADON') IS NOT NULL
	DROP TABLE HOADON
GO

CREATE TABLE HOADON
(
	ID_HOADON INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
	ID_NHANVIEN VARCHAR(10) NOT NULL,
	NGAYTAO DATETIME DEFAULT GETDATE(),
	TRANGTHAI BIT DEFAULT 1,
	TTTHANHTOAN BIT DEFAULT 0,
	THANHTIEN INT,
	LYDOHUY NVARCHAR(100),
	SOLUONGSANPHAM INT,
	GHICHU NVARCHAR(100),
	SDT NVARCHAR(11),
	TEN NVARCHAR(50),
	DIACHI NVARCHAR(50),
	TIENSHIP INT
	FOREIGN KEY(ID_Nhanvien) REFERENCES dbo.NhanVien
)
GO

IF OBJECT_ID('LOAISANPHAM') IS NOT NULL
	DROP TABLE LOAISANPHAM
GO

CREATE TABLE LOAISANPHAM 
(
	ID_LOAISANPHAM VARCHAR(10) NOT NULL PRIMARY KEY,
	TENLOAI NVARCHAR(30) NOT NULL	
)
GO

IF OBJECT_ID('DONVISANPHAM') IS NOT NULL
	DROP TABLE DONVISANPHAM
GO

CREATE TABLE DONVISANPHAM
(
	ID_DONVISANPHAM VARCHAR(10) NOT NULL PRIMARY KEY,
	TENDOVI NVARCHAR(30) NOT NULL,
 	KICHTHUOC INT NOT NULL 	
)
GO

IF OBJECT_ID('SANPHAM') IS NOT NULL
	DROP TABLE SANPHAM
GO

CREATE TABLE SANPHAM(
	ID_SANPHAM VARCHAR(10) PRIMARY KEY NOT NULL,
	TENSANPHAM NVARCHAR(100) NOT NULL,
	GIA INT NOT NULL,
	ID_DONVISP VARCHAR(10)  NOT NULL,
	ID_LOAISP VARCHAR(10) NOT NULL,
	TRANGTHAI BIT DEFAULT 1,
	HINH NVARCHAR(100),
	FOREIGN KEY(ID_DonviSP) REFERENCES dbo.DONVISANPHAM,
	FOREIGN KEY(ID_LoaiSP) REFERENCES dbo.LOAISANPHAM
)
GO


IF OBJECT_ID('BAN') IS NOT NULL
	DROP TABLE BAN
GO

CREATE TABLE BAN
(
	ID_BAN INT NOT NULL PRIMARY KEY,
	TRANGTHAI BIT, -- bàn ?o = 0 ?? t?o ??n hàng mang v? bàn oder t?i quán =1
	HOATDONG BIT,
	SOLUONGCHO INT,
)
GO

IF OBJECT_ID('CHITIETBAN') IS NOT NULL
	DROP TABLE CHITIETBAN
GO

CREATE TABLE CHITIETBAN
(
	ID_BAN INT NOT NULL,
	ID_HOADON INT NOT NULL,
	THOIDIEMCONGUOI TIME,
	DONCHINH BIT 	
	FOREIGN KEY(ID_Ban) REFERENCES dbo.BAN,
	FOREIGN KEY(ID_HOADON) REFERENCES dbo.HOADON
)
GO

IF OBJECT_ID('HOADONCHITIET') IS NOT NULL
	DROP TABLE HOADONCHITIET
GO

CREATE TABLE HOADONCHITIET(
	ID_HOADON INT NOT NULL,
	ID_SANPHAM VARCHAR(10) NOT NULL,
	SOLUONG INT NOT NULL,
	GIA INT NOT NULL,
	TONGGIA INT NOT NULL,
	TRANGTHAITHANHTOAN BIT DEFAULT 0,
	LYDOHUY  NVARCHAR(100),
	GHICHU NVARCHAR(100)
	--TRANGTHAI THANH TOÁN
	FOREIGN KEY(ID_HoaDon) REFERENCES dbo.HOADON,
	FOREIGN KEY(ID_SanPham) REFERENCES dbo.SANPHAM
)
GO

IF OBJECT_ID('BANDAT') IS NOT NULL
	DROP TABLE BANDAT
GO

CREATE TABLE BANDAT
(
	ID_BAN INT NOT NULL,
	ID_NHANVIEN VARCHAR(10) NOT NULL,
	TENKH NVARCHAR(50) NOT NULL,
	SDT VARCHAR(11) NOT NULL,
	THOIGIAN TIME NOT NULL,
	FOREIGN KEY(ID_Ban) REFERENCES dbo.BAN,
	FOREIGN KEY(ID_NhanVien) REFERENCES dbo.NHANVIEN
)
GO

IF OBJECT_ID('GIAMGIA') IS NOT NULL
	DROP TABLE GIAMGIA
GO

CREATE TABLE GIAMGIA
(
	ID_GIAMGIA INT IDENTITY(1,1) PRIMARY KEY,
	TENSUKIEN NVARCHAR(100),
	ID_NHANVIEN VARCHAR(10),
	NGAYBD DATETIME,
	NGAYKT DATETIME,
	FOREIGN KEY(ID_Nhanvien) REFERENCES dbo.NHANVIEN
)
GO

IF OBJECT_ID('GIAMGIACHITIET') IS NOT NULL
	DROP TABLE GIAMGIACHITIET
GO

CREATE TABLE GIAMGIACHITIET
(
	ID_GIAMGIA INT,
	ID_SANPHAM VARCHAR(10),
	GIAM INT,
	FOREIGN KEY(Id_GiamGia) REFERENCES dbo.GIAMGIA,
	FOREIGN KEY(ID_Sanpham) REFERENCES dbo.SANPHAM
)
GO

--thêm dữ liệu LOAISANPHAM
INSERT INTO dbo.LOAISANPHAM(ID_LOAISANPHAM,TENLOAI)
VALUES('LSP1',N'Cà phê'),
	('LSP2',N'Sinh tố'),
	('LSP3',N'Nước ngọt'),
	('LSP4',N'Trà'),
	('LSP5',N'sữa')


-- thêm dữ liệu đơn vị sản phẩm
INSERT INTO dbo.DONVISANPHAM(ID_DONVISANPHAM,TENDOVI,KICHTHUOC)
VALUES('DV1',N'Cốc',250) 

--thêm dữ liệu sản phẩm
INSERT INTO dbo.SANPHAM(ID_SANPHAM,TENSANPHAM,GIA,ID_DONVISP,ID_LOAISP,TRANGTHAI,HINH)
VALUES('SP01',N'Cà phê trứng',20000,'DV1','LSP1',1,N'cach-pha-cafe-trung.jpg'),
	('SP02',N'Cà phê Americano',20000,'DV1','LSP1',1,N'CafeYAmericano.jpg'),
	('SP03',N'Cà phê đường',20000,'DV1','LSP1',1,N'CafeYAmericano.jpg'),
	('SP04',N'Cà phê mocha',20000,'DV1','LSP1',1,N'CafeYMocha.jpg'),
	('SP05',N'Đen đá',20000,'DV1','LSP1',1,N'capheden.png'),
	('SP06',N'Cà phê FlatWhite',20000,'DV1','LSP1',1,N'CapheFlatWhite.jpg'),
	('SP07',N'Cà phê nhỏ giọt',15000,'DV1','LSP1',1,N'caphenhorot.png'),
	('SP08',N'Latte',20000,'DV1','LSP1',1,N'capheyLatte.jpg'),
	('SP09',N'Capuchino',25000,'DV1','LSP1',1,N'capuchino.jpg'),
	('SP10',N'ColdBrew',25000,'DV1','LSP1',1,N'ColdBrewCofffee.jpg'),
	('SP11',N'Cookie Cream',24000,'DV1','LSP2',1,N'Cookie-Cream.jpg'),
	('SP12',N'Pepsi',20000,'DV1','LSP3',1,N'lon-nuoc-ngot-pepsi.jpg'),
	('SP13',N'Milk snake',30000,'DV1','LSP3',1,N'milkshake.jpg'),
	('SP14',N'7 UP',20000,'DV1','LSP3',1,N'nuoc-ngot-7up-thai-lon-330ml.jpg'),
	('SP15',N'Coca Cola',20000,'DV1','LSP3',1,N'nuoc-ngot-coca-cola.jpg'),
	('SP16',N'Smothie',30000,'DV1','LSP2',1,N'smoothies-e1601295150109.jpg'),
	('SP17',N'Socola đá xay',30000,'DV1','LSP2',1,N'socola-da-xay.jpg'),
	('SP18',N'Soda ý',20000,'DV1','LSP1',1,N'soda-y.jpg'),
	('SP19',N'Sprite',20000,'DV1','LSP3',1,N'sprite.jpg'),
	('SP20',N'Sữa tươi trân châu',25000,'DV1','LSP5',1,N'sua-tuoi-chan-trau-duong-den.jpg'),
	('SP21',N'Sữa tươi trân châu đường đen',25000,'DV1','LSP5',1,N'sua-tuoi-chan-trau-duong-den.jpg'),
	('SP22',N'Trà đào chanh sả',35000,'DV1','LSP4',1,N'tra-dao-chanh-sa-e1601333987367.jpg'),
	('SP23',N'Trà hoa quả',35000,'DV1','LSP4',1,N'tra-hoa-qua.jpg'),
	('SP24',N'Trà hoa đậu biếc',35000,'DV1','LSP4',1,N'ttra-hoa-dau-biec-e1601334294642.jpg'),
	('SP25',N'Trà chanh leo',25000,'DV1','LSP1',1,N'tra-xanh-chanh-leo-kim-quat-mat-ong.jpg'),
	('SP26',N'Trà phô mai kem sữa',25000,'DV1','LSP1',1,N'tra-pho-mai-kem-sua.jpg')


--thêm dữ liệu bảng nhân viên
INSERT INTO dbo.NHANVIEN(ID_NHANVIEN,TENNV,GIOITINH,NGAYSINH,DIACHI,EMAIL,SDT,USERNAME,PASS,VAITRO,TRANGTHAI,HINH)
VALUES('NV1',N'Nguyễn Chí Công',1,'2002/08/24',N'Hà Nam',N'cong1234@gmail.com',N'0123456789','congnc','123456',1,1,N''),
('NV2',N'Nguyễn Đức Vinh',1,'1997/05/13',N'Ninh Bình',N'vinh1234@gmail.com',N'0123456798','vinhnd','111111',1,0,N''),
('NV3',N'Trần Trường Sơn',1,'1997/05/13',N'Phú Thọ',N'son1234@gmail.com',N'0123456978','sontt','222222',1,1,N''),
('NV4',N'Trần Văn Đức',1,'1999/05/13',N'Ninh Bình',N'duc1234@gmail.com',N'0123465978','sontt','333333',1,0,N'')
